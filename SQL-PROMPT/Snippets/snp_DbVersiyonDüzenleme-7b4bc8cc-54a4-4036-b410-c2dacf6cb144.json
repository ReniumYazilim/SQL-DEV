{
  "id": "7b4bc8cc-54a4-4036-b410-c2dacf6cb144",
  "prefix": "snp_DbVersiyonDüzenleme",
  "description": "",
  "body": "\r\nUpdate  DM\r\nSet     DM.ScriptContent = CONCAT(\r\n                               '-- RN100_ScreenKullanici tablosunu kontrol et\r\nIF NOT EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N''dbo.RN100_ScreenKullanici'') AND type = ''U'')\r\nBEGIN\r\n    -- Tablo yoksa tamamen oluştur\r\n    CREATE TABLE [dbo].[RN100_ScreenKullanici]\r\n    (\r\n        [ScreenKullaniciID] [int] NOT NULL IDENTITY(1, 1),\r\n        [ScreenID] [int] NOT NULL,\r\n        [KullaniciID] [int] NOT NULL,\r\n        [ITVisible] [tinyint] NULL,\r\n        [AddDate] [smalldatetime] NULL,\r\n        [AddUser] [int] NULL,\r\n        [UpdateDate] [smalldatetime] NULL,\r\n        [UpdateUser] [int] NULL,\r\n        [IsITUpdate] [tinyint] NULL,\r\n        [IsFavorite] [bit] NULL,\r\n        [OctoCoreGuid] [uniqueidentifier] NULL \r\n            CONSTRAINT [DF_RN100_ScreenKullanici_OctoCoreGuid] DEFAULT (newsequentialid())\r\n    ) ON [PRIMARY];\r\n\r\n    ALTER TABLE [dbo].[RN100_ScreenKullanici] \r\n        ADD CONSTRAINT [PK_RN100_ScreenKullanici] \r\n        PRIMARY KEY CLUSTERED ([ScreenKullaniciID]) ON [PRIMARY];\r\n\r\n    CREATE UNIQUE NONCLUSTERED INDEX [UIX_RN100_ScreenKullanici_OctoCoreGuid] \r\n        ON [dbo].[RN100_ScreenKullanici] ([OctoCoreGuid]) ON [PRIMARY];\r\nEND\r\nELSE\r\nBEGIN\r\n    -- Tablo varsa, kolon kontrol et\r\n    IF COL_LENGTH(''dbo.RN100_ScreenKullanici'', ''OctoCoreGuid'') IS NULL\r\n    BEGIN\r\n        ALTER TABLE [dbo].[RN100_ScreenKullanici]\r\n        ADD [OctoCoreGuid] [uniqueidentifier] NULL \r\n            CONSTRAINT [DF_RN100_ScreenKullanici_OctoCoreGuid] DEFAULT (newsequentialid());\r\n\r\n        -- Index yoksa ekle\r\n        IF NOT EXISTS (\r\n            SELECT 1 \r\n            FROM sys.indexes \r\n            WHERE name = ''UIX_RN100_ScreenKullanici_OctoCoreGuid'' \r\n              AND object_id = OBJECT_ID(''dbo.RN100_ScreenKullanici'')\r\n        )\r\n        BEGIN\r\n            CREATE UNIQUE NONCLUSTERED INDEX [UIX_RN100_ScreenKullanici_OctoCoreGuid] \r\n                ON [dbo].[RN100_ScreenKullanici] ([OctoCoreGuid]) ON [PRIMARY];\r\n        END\r\n    END\r\nEND', CHAR(13) + CHAR(10), DM.ScriptContent)\r\nFrom    dbo.Db_Migrations DM\r\nWhere   DM.Id = 1;\r\n"
}